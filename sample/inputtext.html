<!doctype html>
<html lang="ko" >
<head>
	<title>CanvasHelper</title>
	<meta charset="utf-8">
	<meta http-equiv="Content-Script-Type" content="text/javascript">
	<meta http-equiv="Content-Style-Type" content="text/css">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="shortcut icon" href="http://www.mins01.com/favicon.ico">	
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<script src="/js/ForGoogle.js"></script>
	<!-- google analytics -->
	<script>if(window.ForGoogle){ ForGoogle.analytics() }else{ console.log("failure : ForGoogle.analytics()");}</script>
	

	<!-- jquery ê´€ë ¨ -->
	<!-- <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script> -->

	<!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© 4 : IE8ì§€ì›ì•ˆë¨! -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" crossorigin="anonymous"> 
	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" crossorigin="anonymous"></script>  -->
	<!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" crossorigin="anonymous"></script> -->
	<!-- vue.js -->
	<!-- <script src="https://cdn.jsdelivr.net/npm/vue"></script> -->
	

    <!-- https://fonts.google.com/specimen/Gugi -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Gugi&display=swap" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css2?family=Gugi&display=swap" rel="stylesheet">

	<!-- meta og -->
	
	<meta property="og:title" content="CanvasHelper">
	<meta property="og:description" content="CanvasHelper">
	<meta name="og:image" content="http://www.mins01.com/img/logo.gif">
	<meta property="og:image:width" content="190">
	<meta property="og:image:height" content="70" />
	<meta property="og:site_name" content="CanvasHelper" />
	<meta property="og:type" content="website">


    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Pen+Script&display=swap" rel="stylesheet">

	<style>
		img,canvas{
			outline:2px solid #999;
			outline-offset: -2px;
			vertical-align: middle;
			background-image: url(bg.gif);
		}
		img{
			outline-color: rgb(98, 209, 116);
		}
		canvas{
			outline-color: rgb(160, 51, 51);
		}
	</style>
    <script src="../CanvasHelper.js"></script>
	<script>
		// let canvas = null;

	</script>
    <script>
        function syncCanvas(event){
            const img_bg = document.querySelector('#img_bg');
            const canvas_inputtext = document.querySelector('#canvas_inputtext');
            const textarea_inputtext = document.querySelector('#textarea_inputtext');
            let comment = textarea_inputtext.value;

            let ilimit = 100;
            if(event && textarea_inputtext.scrollHeight > textarea_inputtext.offsetHeight ){ // textarea ë†’ì´ ì´ìƒì˜ ë¬¸ìì—´ì„ ë°›ì„ ìˆ˜ ì—†ê²Œ.
                event.stopPropagation();
                while(textarea_inputtext.scrollHeight > textarea_inputtext.offsetHeight && ilimit--){
                    textarea_inputtext.value = textarea_inputtext.value.substr(0,textarea_inputtext.value.length -1);
                }
                return false;
            }

            let lineHeightPx = 40;
            let paddingPx = 10;
            let bgFillStyle = null;
            var ctxTextConf={
                'font':"40px 'Nanum Pen Script', cursive",
                fillStyle:'#0000ff',
                // strokeStyle:'#000',
                strokeStyle:'transparent',
                textAlign:'center',
                // textAlign:'left',
                textBaseline:"alphabetic", //ì´ê²ƒë§Œ ì‚¬ìš©í•˜ë¼ ë‚˜ë¨¸ì§„ ëŒ€ì‘ì„...
            }
            let textCanvas = CanvasHelper.canvasByText(comment,300,300,lineHeightPx,ctxTextConf,paddingPx,bgFillStyle);
            CanvasHelper.drawImageCanvas(canvas_inputtext,img_bg,0,0,300,300);
            CanvasHelper.drawImageCanvas(canvas_inputtext,textCanvas,0,0);
        }

        window.addEventListener('load',(event)=>{
            syncCanvas(null)
        })
        document.fonts.ready.then(function (fontFaceSetÂ ) {
            console.log('fonts.ready',fontFaceSet);
            syncCanvas();
        });
    </script>
    <style>
        #canvas_inputtext{
            position: relative;
            z-index: 1;
            display: block;
            margin:0 auto;
            outline: 2px solid #00f;
        }
        #textarea_inputtext{
            font-family: 'Nanum Pen Script', cursive , Arial, Helvetica, sans-serif	;
            font-size: 40px;
            line-height: 40px;
            padding:10px;
            text-align: center;
            white-space: break-spaces; /* ê³µë°±ê¸°í˜¸ê°€ ë¬´ì¡°ê±´ ë³´ì´ê³ , ì¤„ë°”ê¿ˆ ë˜ë„ë¡ */
            word-wrap: break-word;
            position: relative;
            z-index: 2;
            display: block;
            margin:0 auto;
            width:300px; height:300px;
            border-width: 0px;
            background-color: transparent;
            color: transparent;
            caret-color: #000;
            margin-top:-300px;
            overflow: hidden;
        }
        #textarea_inputtext.show-text{
            color: #ff0000;
            outline: 2px dotted #f00;

        }
    </style>
</head>
<body>
    <div class="container">
        <h1>CanvasHelper</h1>
        <h2>í…ìŠ¤íŠ¸ ì…ë ¥ ìƒ˜í”Œ</h2>
        <hr>
        <ul class="list-group">
            <li class="list-group-item">
                í°íŠ¸ ì„ ì • ì£¼ì˜ :  whitespcace(ë¹ˆì¹¸,ê³µë°±ê¸°í˜¸)ê°€ ê°€ë³€í­ ì§€ì›ë˜ëŠ” ê²½ìš°, ë„ˆë¹„ ê³„ì‚°ì´ í‹€ì–´ì§„ë‹¤! <br>noto sans ê°™ì€ ê²½ìš° whitespace ê°€ ìƒí™©ì— ë”°ë¼ì„œ ë‹¤ë¥¸ ë„ˆë¹„ë¥¼ ê°€ì§„ë‹¤.
            </li>
            <li class="list-group-item">ìµœëŒ€í•œ ë§ì¶°ì„œ textarea ìª½ ê¸€ìê°€ canvasë³´ë‹¤ ì¡°ê¸ˆ ë” ìœ—ìª½ì— ì íŒë‹¤. ì–¼ë§ˆ ì°¨ì´ê°€ ì—†ì–´ì„œ ë¬´ì‹œ.</li>
            <li class="list-group-item">font(ê¸€ê¼´) ì— ë”°ë¼ì„œ í•œìê°€ ì§€ì› ì•ˆë˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤. ì›¹ í°íŠ¸ì˜ ë²”ìœ„ë¥¼ ì§€ì •í•´ì£¼ê±°ë‚˜ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ í°íŠ¸ë¥¼ ì‚¬ìš©í•˜ë¼.</li>
            <li class="list-group-item">font(ê¸€ê¼´) ì— ë”°ë¼ì„œ í•œê¸€ ì¡°í•© ì¤‘ ê¸€ì ëª¨ì–‘ì´ ë‹¤ë¥´ê²Œ ë³´ì´ëŠ” ê²½ìš°ê°€ ìˆë‹¤.(ì›¹ í°íŠ¸ì—ì„œ í•´ë‹¹ ê¸€ìì—ì„œ í•„ìš” í•  ë•Œ ì›¹ í°íŠ¸ë¥¼ ì½ì–´ë“¤ì´ê¸° ë•Œë¬¸ì´ë‹¤.)</li>
            <li class="list-group-item">ì›¹ í°íŠ¸ë“±ì„ ì‚¬ìš©ì‹œ í°íŠ¸ ë¡œë”©ì— ë”°ë¥¸ ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ì„œ <code>document.fonts.ready(()=>{~~~})</code>ì˜ ì‚¬ìš©ì„ ìƒê°í•´ ë³¼ ìˆ˜ ìˆë‹¤.</li>
        </ul>
        <hr>
        <div spellcheck="false">
            <h3>ì…ë ¥ í…ŒìŠ¤íŠ¸</h3>
            <div class="text-center">
                <button type="button" class="btn btn-info m-1" onclick="document.querySelector('#textarea_inputtext').classList.toggle('show-text')">textarea ê¸€ì ë³´ì´ê²Œ</button>
                <button class="btn btn-success" type="button" onclick="CanvasHelper.downloadCanvas(document.querySelector('#canvas_inputtext'),'image/png',1,'í…ŒìŠ¤íŠ¸_'+(new Date()).toISOString()+'.png');return false">ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ</button>

            </div>
            <canvas id="canvas_inputtext" width="300" height="300"></canvas>
            <textarea id="textarea_inputtext" 
            onkeypress="syncCanvas(event);" 
            onkeyup="syncCanvas(event)"
            onchange="syncCanvas(event)"
            oninput="syncCanvas(event)"
            oncompositionupdate="syncCanvas(event)"
            oncompositionstart="syncCanvas(event)"
            oncompositionend="syncCanvas(event)"
            
            >í…ŒìŠ¤íŠ¸&#13;ğŸ˜ƒì´ëª¨ì§€&#13;123 ABC abc å¤§ä¸­å°&#13;í°íŠ¸ê°€ í•œì ì§€ì› ì•ˆí•¨</textarea>
        </div>
        <div>
            <h3>ë°°ê²½ì´ë¯¸ì§€</h3>
            <img id="img_bg" src="../20221115182629545.png">
        </div>
    </div> 
</body>
</html>
